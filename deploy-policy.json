{
  "Version": "2012-10-17",
  "Statement": [
    { "Sid": "TerraformStateS3",
      "Effect": "Allow",
      "Action": ["s3:ListBucket"],
      "Resource": ["arn:aws:s3:::desafio-tfstate-irvi-1755189166"]
    },
    { "Sid": "TerraformStateS3Objects",
      "Effect": "Allow",
      "Action": ["s3:GetObject","s3:PutObject","s3:DeleteObject"],
      "Resource": ["arn:aws:s3:::desafio-tfstate-irvi-1755189166/*"]
    },
    { "Sid": "TerraformLockDDB",
      "Effect": "Allow",
      "Action": ["dynamodb:DescribeTable","dynamodb:PutItem","dynamodb:GetItem","dynamodb:DeleteItem","dynamodb:UpdateItem"],
      "Resource": ["arn:aws:dynamodb:us-east-1:160927904809:table/desafio-tf-locks"]
    },

    { "Sid": "LambdaOps",
      "Effect": "Allow",
      "Action": [
        "lambda:CreateFunction","lambda:UpdateFunctionCode","lambda:UpdateFunctionConfiguration",
        "lambda:PublishVersion","lambda:DeleteFunction","lambda:GetFunction",
        "lambda:AddPermission","lambda:RemovePermission"
      ],
      "Resource": ["arn:aws:lambda:us-east-1:160927904809:function:challenge-api*"]
    },

    { "Sid": "PassOnlyLambdaRole",
      "Effect": "Allow",
      "Action": ["iam:PassRole"],
      "Resource": ["arn:aws:iam::160927904809:role/challenge-api-role"]
    },

    { "Sid": "IamForLambdaRoleSelfService",
      "Effect": "Allow",
      "Action": [
        "iam:CreateRole","iam:DeleteRole","iam:PutRolePolicy","iam:DeleteRolePolicy","iam:GetRole"
      ],
      "Resource": ["arn:aws:iam::160927904809:role/challenge-api-role"]
    },

    { "Sid": "ApiGwCrud",
      "Effect": "Allow",
      "Action": ["apigateway:POST","apigateway:GET","apigateway:PUT","apigateway:DELETE","apigateway:PATCH"],
      "Resource": "arn:aws:apigateway:us-east-1::/restapis*"
    },

    { "Sid": "CloudWatchLogsForLambda",
      "Effect": "Allow",
      "Action": ["logs:CreateLogGroup","logs:CreateLogStream","logs:PutLogEvents","logs:PutRetentionPolicy"],
      "Resource": "*"
    }
  ]
}
